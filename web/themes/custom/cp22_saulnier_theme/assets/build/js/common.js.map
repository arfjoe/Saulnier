{"version":3,"file":"common.js","sources":["../../src/javascript/src/common/utilities/KeyFigureHandler.js","../../src/javascript/src/common/utilities/StickyHeader.js","../../src/javascript/src/common/utilities/Dropdown.js","../../src/javascript/src/common/utilities/Tabs.js"],"sourcesContent":["class KeyFigureHandler {\n\n    /**\n     * \n     * @param {NodeList} elements \n     * @param {Object} options \n     */\n    constructor(elements, options) {\n        this.elements = elements;\n        this.options = this.parseOptions(options);\n        this.onObserve = this.onObserve.bind(this);\n        this.observer = new IntersectionObserver(this.onObserve, {});\n        for (const element of elements) {\n            this.observer.observe(element);\n        }\n        this.animate = this.animate.bind(this);\n    }\n\n    /**\n     * \n     * @param {Object} options \n     * @returns {Object}\n     */\n    parseOptions(options) {\n        const defaultOptions = {\n            animate: true,\n            detectPercentage: false,\n            animationDuration: 2000,\n            frameDuration: 500,\n            detectBigNumbers: true,\n        }\n        return { ...defaultOptions, ...options };\n    }\n\n    /**\n     * \n     * @param {IntersectionObserverEntry} entries \n     * @param {IntersectionObserver} observer \n     */\n    onObserve(entries, observer) {\n        entries.forEach(entry => {\n\n            if (!entry.isIntersecting)\n                return;\n\n            if (this.options.animate)\n                this.animate(entry.target);\n\n            observer.unobserve(entry.target);\n\n        })\n    }\n\n    /**\n     * \n     * @param {Element} element \n     */\n    animate(element) {\n        // Calculate how long each ‘frame’ should last if we want to update the animation 60 times per second\n        const frameDuration = this.options.frameDuration / 60;\n        // Use that to calculate how many frames we need to complete the animation\n        const totalFrames = Math.round(this.options.animationDuration / frameDuration);\n        // An ease-out function that slows the count as it progresses\n        const easeOutQuad = t => t * (2 - t);\n\n        let frame = 0;\n        let hasPercentage = false;\n\n        let sanitizedElement = element.textContent.trim().replace(new RegExp(\" \", \"g\"), \"\");\n\n        if (this.options.detectPercentage && sanitizedElement.includes('%'))\n            hasPercentage = true;\n\n        const countTo = parseInt(sanitizedElement, 10);\n        // Start the animation running 60 times per second\n        if (!isNaN(countTo)) {\n            const counter = setInterval(() => {\n\n                frame++;\n                // Calculate our progress as a value between 0 and 1\n                // Pass that value to our easing function to get our\n                // progress on a curve\n                const progress = easeOutQuad(frame / totalFrames);\n                // Use the progress value to calculate the current count\n                const currentCount = Math.round(countTo * progress);\n\n                // If the current count has changed, update the element\n                if (parseInt(element.textContent, 10) !== currentCount) {\n                    element.textContent = `${drupalSettings && this.options.detectBigNumbers ?\n                        currentCount.toLocaleString(drupalSettings.langCode) : currentCount} ${hasPercentage ? '%' : ''}`;\n                }\n\n                // If we’ve reached our last frame, stop the animation\n                if (frame === totalFrames) {\n                    clearInterval(counter);\n                }\n            }, frameDuration);\n        }\n    }\n}\n\nexport { KeyFigureHandler };\n","/**\n * Add js-sticky CSS class on <body> while scrolling\n */\n class StickyHeader {\n\n    /**\n     * @param {HTMLElement} element \n     */\n    constructor(element) {\n        this.$Body = document.getElementsByTagName('body')[0];\n        this.sticky = element.offsetTop + element.offsetHeight;\n        this.onScroll = this.onScroll.bind(this);\n        this.stickIt = this.stickIt.bind(this);\n        window.addEventListener('scroll', this.onScroll);\n        this.stickIt();\n    }\n\n    onScroll() {\n        window.requestAnimationFrame(this.stickIt);\n    }\n\n    stickIt() {\n        if(window.pageYOffset > this.sticky) {\n            this.$Body.classList.add('js-sticky');\n        } else {\n            this.$Body.classList.remove('js-sticky');\n        }\n    }\n\n}\n\nexport { StickyHeader };","/**\n * Enables dropdown on a\n * <div class=\"dropdown\">\n *  <div class=\"dropdown-menu\"></div>\n * </div>\n * template\n */\n class Dropdown {\n\n    /**\n     * @param {HTMLElement} element \n     */\n    constructor(element) {\n        this.element = element;\n        this.dropDownMenu = this.getDropDownMenu();\n        this.ariaExpandedValue = this.element.getAttribute('aria-expanded') === 'true';\n        this.toggleDropdown = this.toggleDropdown.bind(this);\n        this.element.addEventListener('click', this.toggleDropdown);\n        this.element.addEventListener('focusout', this.toggleDropdown);\n    }\n\n    getDropDownMenu() {\n        return this.element.querySelectorAll('.dropdown-menu')[0];\n    }\n\n    toggleDropdown(e) {\n        this.element.setAttribute('aria-expanded', !this.ariaExpandedValue);\n        this.ariaExpandedValue = !this.ariaExpandedValue;\n        if(e.type === 'focusout' && !this.element.classList.contains('opened')) {\n            return;\n        }\n        this.element.classList.toggle('opened');\n    }\n\n    /**\n     * @returns {Dropdown[]}\n     */\n    static bind() {\n        return Array.from(document.querySelectorAll('.dropdown')).map((element) => {\n            return new Dropdown(element);\n        });\n    }\n}\n\nexport { Dropdown }","/**\n * Enable Accesible Tabs\n * HTML :\n * <div class=\"tabs\">\n        <div class=\"tablist\" role=\"tablist\" aria-label=\"{{ 'Teacher tabs'|t }}\">\n            <button role=\"tab\" aria-selected=\"true\" aria-controls=\"first-tab\" id=\"firstTab\">\n                {{ 'First Tab'|t }}\n            </button>\n            <button role=\"tab\" aria-selected=\"false\" aria-controls=\"second-tab\" id=\"secondTab\">\n                {{ 'Second Tab'|t }}\n            </button>\n        </div>\n        <div class=\"tabs-progress\"></div>\n        <div tabindex=\"0\" role=\"tabpanel\" id=\"first-tab-\" aria-labelledby=\"{{ 'First tab'|t }}\">\n                {{ firstTab }}\n        </div>\n        <div tabindex=\"0\" role=\"tabpanel\" id=\"second-tab\" aria-labelledby=\"{{ 'Second tab'|t }}\" hidden=\"\">\n                {{ secondTab }}\n        </div>\n    </div>\n */\n\n    class Tabs {\n        constructor(element) {\n            this.tab = element;\n            this.tablist = this.tab.querySelectorAll('[role=\"tablist\"]')[0];\n            this.tabProgress = this.tab.querySelectorAll('.tabs-progress')[0] || null;\n            this.tabProgressBar;\n            this.tabProgressIndicator;\n            this.tabs;\n            this.panels;\n            this.keys = {\n                end: 35,\n                home: 36,\n                left: 37,\n                up: 38,\n                right: 39,\n                down: 40,\n                delete: 46\n            };\n            this.direction = {\n                37: -1,\n                38: -1,\n                39: 1,\n                40: 1\n            };\n            this.delay = this.determineDelay();\n            this.generateArrays();\n            this.determineFirstFocus();\n            this.tabProgress && this.enableTabProgress();\n            this.addListeners = this.addListeners.bind(this);\n            this.activateTab = this.activateTab.bind(this);\n            this.clickEventListener = this.clickEventListener.bind(this);\n            this.keydownEventListener = this.keydownEventListener.bind(this);\n            this.keyupEventListener = this.keyupEventListener.bind(this);\n            this.determineOrientation = this.determineOrientation.bind(this);\n            this.deactivateTabs = this.deactivateTabs.bind(this);\n            this.determineDeletable = this.determineDeletable.bind(this);\n            this.updateProgressTab = this.updateProgressTab.bind(this);\n            // Bind listeners\n            for (let i = 0; i < this.tabs.length; ++i) {\n                this.addListeners(i);\n            };\n        }\n    \n    \n        /**\n           * @returns {Tabs[]}\n           */\n        static bind() {\n            return Array.from(document.querySelectorAll('.tabs')).map((element) => {\n                return new Tabs(element);\n            });\n        }\n    \n        determineFirstFocus() {\n            this.activateTab(this.tabs[0], false, true)\n        }\n    \n        generateArrays() {\n            this.tabs = this.tab.querySelectorAll('[role=\"tab\"]');\n            this.panels = this.tab.querySelectorAll('[role=\"tabpanel\"]');\n        }\n    \n        enableTabProgress() {\n            //CREATION DE LA BARRE DE PROGRES\n            let progressBar = document.createElement('span');\n            progressBar.classList.add('tabs-progress-bar');\n            progressBar.style.width = '0%';\n            progressBar.style.transition = 'width 250ms cubic-bezier(.84,.01,.19,.99)';\n    \n            //CREATION DE L'INDICATEUR DE PROGRES\n            let progressIndicator = document.createElement('span');\n            progressIndicator.classList.add('tabs-progress-indicator');\n            progressIndicator.style.left = '0';\n            progressIndicator.style.transition = 'left 250ms cubic-bezier(.84,.01,.19,.99)';\n    \n            this.tabProgress.appendChild(progressBar);\n            this.tabProgress.appendChild(progressIndicator);\n    \n            this.tabProgressBar = progressBar;\n            this.tabProgressIndicator = progressIndicator;\n            //On cherche la tab list qui est focus\n            let focusedTab = this.getFocusedTab();\n            this.updateProgressTab(focusedTab);\n        }\n    \n        getFocusedTab() {\n            return this.tab.querySelectorAll('[role=\"tab\"][aria-selected=\"true\"]')[0];\n        }\n    \n        updateProgressTab(focusedTab) {\n            //On calcule la position de progrès\n            let progressPercentage = (((focusedTab.offsetWidth / 2) + focusedTab.getBoundingClientRect().left - this.tab.getBoundingClientRect().left) * 100) / this.tabProgress.offsetWidth;\n            let progress = (focusedTab.offsetWidth / 2) + focusedTab.getBoundingClientRect().left - this.tab.getBoundingClientRect().left;\n          \n            this.tabProgressBar.style.width = `${progressPercentage}%`;\n            this.tabProgressIndicator.style.left = `${progress - this.tabProgressIndicator.offsetWidth / 2}px`;\n        }\n    \n    \n        addListeners(index) {\n            this.tabs[index].addEventListener('click', this.clickEventListener);\n            this.tabs[index].addEventListener('keydown', this.keydownEventListener);\n            this.tabs[index].addEventListener('keyup', this.keyupEventListener);\n    \n            // Build an array with all tabs (<button>s) in it\n            this.tabs[index].index = index;\n        }\n    \n        // When a tab is clicked, activateTab is fired to activate it\n        clickEventListener(event) {\n            let tab = event.target;\n            this.activateTab(tab, false);\n        }\n    \n        // Handle keydown on tabs\n        keydownEventListener(event) {\n            let key = event.keyCode;\n    \n            switch (key) {\n                case this.keys.end:\n                    event.preventDefault();\n                    // Activate last tab\n                    this.activateTab(this.tabs[this.tabs.length - 1]);\n                    break;\n                case this.keys.home:\n                    event.preventDefault();\n                    // Activate first tab\n                    this.activateTab(this.tabs[0]);\n                    break;\n    \n                // Up and down are in keydown\n                // because we need to prevent page scroll >:)\n                case this.keys.up:\n                case this.keys.down:\n                    this.determineOrientation(event);\n                    break;\n            };\n        }\n    \n        // Handle keyup on tabs\n        keyupEventListener(event) {\n            let key = event.keyCode;\n            switch (key) {\n                case this.keys.left:\n                case this.keys.right:\n                    this.determineOrientation(event);\n                    break;\n                case this.keys.delete:\n                    this.determineDeletable(event);\n                    break;\n            };\n        }\n    \n        // When a tablistâ€™s aria-orientation is set to vertical,\n        // only up and down arrow should  .\n        // In all other cases only left and right arrow  .\n        determineOrientation(event) {\n            let key = event.keyCode;\n            let vertical = this.tablist.getAttribute('aria-orientation') == 'vertical';\n            let proceed = false;\n    \n            if (vertical) {\n                if (key === this.keys.up || key === this.keys.down) {\n                    event.preventDefault();\n                    proceed = true;\n                };\n            }\n            else {\n                if (key === this.keys.left || key === this.keys.right) {\n                    proceed = true;\n                };\n            };\n    \n            if (proceed) {\n                this.switchTabOnArrowPress(event);\n            };\n        }\n    \n        // Either focus the next, previous, first, or last tab\n        // depening on key pressed\n        switchTabOnArrowPress(event) {\n            let pressed = event.keyCode;\n    \n            for (let x = 0; x < this.tabs.length; x++) {\n                this.tabs[x].addEventListener('focus', this.focusEventHandler, {\n                    preventScroll: true,\n                });\n            };\n    \n            if (this.direction[pressed]) {\n                let target = event.target;\n                if (target.index !== undefined) {\n                    if (this.tabs[target.index + this.direction[pressed]]) {\n                        this.tabs[target.index + this.direction[pressed]].focus();\n                    }\n                    else if (pressed === this.keys.left || pressed === this.keys.up) {\n                        this.focusLastTab();\n                    }\n                    else if (pressed === this.keys.right || pressed == this.keys.down) {\n                        this.focusFirstTab();\n                    };\n                };\n            };\n        }\n    \n        // Activates any given tab panel\n        activateTab(tab, setFocus, firstFocus) {\n            setFocus = setFocus || true;\n            // Deactivate all other tabs\n            this.deactivateTabs();\n    \n            // Remove tabindex attribute\n            tab.removeAttribute('tabindex');\n    \n            // Set the tab as selected\n            tab.setAttribute('aria-selected', 'true');\n    \n            // Get the value of aria-controls (which is an ID)\n            let controls = tab.getAttribute('aria-controls');\n    \n            // Remove hidden attribute from tab panel to make it visible\n            document.getElementById(controls).removeAttribute('hidden');\n            if (!firstFocus) {\n                this.updateProgressTab(tab);\n            }\n            // Set focus when required\n            if (setFocus) {\n                tab.focus({ preventScroll: true });\n            };\n        }\n    \n        // Deactivate all tabs and tab panels\n        deactivateTabs() {\n            for (let t = 0; t < this.tabs.length; t++) {\n                this.tabs[t].setAttribute('tabindex', '-1');\n                this.tabs[t].setAttribute('aria-selected', 'false');\n                this.tabs[t].removeEventListener('focus', this.focusEventHandler);\n            };\n    \n            for (let p = 0; p < this.panels.length; p++) {\n                this.panels[p].setAttribute('hidden', 'hidden');\n            };\n        }\n    \n        // Make a guess\n        focusFirstTab() {\n            this.tabs[0].focus({preventScroll: true});\n        }\n    \n        // Make a guess\n        focusLastTab() {\n            this.tabs[this.tabs.length - 1].focus({preventScroll: true});\n        }\n    \n        // Detect if a tab is deletable\n        determineDeletable(event) {\n            target = event.target;\n    \n            if (target.getAttribute('data-deletable') !== null) {\n                // Delete target tab\n                this.deleteTab(event, target);\n    \n                // Update arrays related to tabs widget\n                this.generateArrays();\n    \n                // Activate the closest tab to the one that was just deleted\n                if (target.index - 1 < 0) {\n                    this.activateTab(this.tabs[0]);\n                }\n                else {\n                    this.activateTab(this.tabs[target.index - 1]);\n                };\n            };\n        }\n    \n        // Deletes a tab and its panel\n        deleteTab(event) {\n            let target = event.target;\n            let panel = document.getElementById(target.getAttribute('aria-controls'));\n    \n            target.parentElement.removeChild(target);\n            panel.parentElement.removeChild(panel);\n        }\n    \n        // Determine whether there should be a delay\n        // when user navigates with the arrow keys\n        determineDelay() {\n            let hasDelay = this.tablist.hasAttribute('data-delay');\n            let delay = 0;\n    \n            if (hasDelay) {\n                let delayValue = this.tablist.getAttribute('data-delay');\n                if (delayValue) {\n                    delay = delayValue;\n                }\n                else {\n                    // If no value is specified, default to 300ms\n                    delay = 300;\n                };\n            };\n    \n            return delay;\n        }\n    \n        //\n        focusEventHandler(event) {\n            let target = event.target;\n    \n            setTimeout(this.checkTabFocus, this.delay, target);\n        }\n    \n        // Only activate tab on focus if it still has focus after the delay\n        checkTabFocus(target) {\n            focused = document.activeElement;\n    \n            if (target === focused) {\n                this.activateTab(target, false);\n            };\n        }\n    }\n    \n    export { Tabs };"],"names":["KeyFigureHandler","elements","options","parseOptions","onObserve","bind","observer","IntersectionObserver","element","observe","animate","defaultOptions","detectPercentage","animationDuration","frameDuration","detectBigNumbers","entries","forEach","entry","isIntersecting","target","unobserve","totalFrames","Math","round","easeOutQuad","t","frame","hasPercentage","sanitizedElement","textContent","trim","replace","RegExp","includes","countTo","parseInt","isNaN","counter","setInterval","progress","currentCount","drupalSettings","toLocaleString","langCode","clearInterval","StickyHeader","$Body","document","getElementsByTagName","sticky","offsetTop","offsetHeight","onScroll","stickIt","window","addEventListener","requestAnimationFrame","pageYOffset","classList","add","remove","Dropdown","dropDownMenu","getDropDownMenu","ariaExpandedValue","getAttribute","toggleDropdown","querySelectorAll","e","setAttribute","type","contains","toggle","Array","from","map","Tabs","tab","tablist","tabProgress","tabProgressBar","tabProgressIndicator","tabs","panels","keys","end","home","left","up","right","down","delete","direction","delay","determineDelay","generateArrays","determineFirstFocus","enableTabProgress","addListeners","activateTab","clickEventListener","keydownEventListener","keyupEventListener","determineOrientation","deactivateTabs","determineDeletable","updateProgressTab","i","length","progressBar","createElement","style","width","transition","progressIndicator","appendChild","focusedTab","getFocusedTab","progressPercentage","offsetWidth","getBoundingClientRect","index","event","key","keyCode","preventDefault","vertical","proceed","switchTabOnArrowPress","pressed","x","focusEventHandler","preventScroll","undefined","focus","focusLastTab","focusFirstTab","setFocus","firstFocus","removeAttribute","controls","getElementById","removeEventListener","p","deleteTab","panel","parentElement","removeChild","hasDelay","hasAttribute","delayValue","setTimeout","checkTabFocus","focused","activeElement"],"mappings":"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"}